<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="utf-8">
  <title>กำลังพาไป TikTok…</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Facebook Pixel -->
  <script>
    !function(f,b,e,v,n,t,s){
      if(f.fbq)return;n=f.fbq=function(){n.callMethod?
      n.callMethod.apply(n,arguments):n.queue.push(arguments)};
      if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
      n.queue=[];t=b.createElement(e);t.async=!0;
      t.src=v;s=b.getElementsByTagName(e)[0];
      s.parentNode.insertBefore(t,s)}(window, document,'script',
      'https://connect.facebook.net/en_US/fbevents.js');
    fbq('init', '127978927946856'); // ใส่ Pixel ID ของคุณ
    fbq('track', 'PageView');
    fbq('track', 'ViewContent');
  </script>
  <noscript>
    <img height="1" width="1" style="display:none"
      src="https://www.facebook.com/tr?id=127978927946856&ev=PageView&noscript=1"/>
  </noscript>

  <!-- TikTok Pixel -->
  <script>
    !function (w, d, t) {
      w.TiktokAnalyticsObject = t;
      var ttq = w[t] = w[t] || [];
      ttq.methods = ["page","track","identify","instances","debug","on","off","once","ready","alias","group","enableCookie"];
      ttq.setAndDefer = function (t, e) { t[e] = function () { t.push([e].concat(Array.prototype.slice.call(arguments, 0))) } };
      for (var i = 0; i < ttq.methods.length; i++) { ttq.setAndDefer(ttq, ttq.methods[i]) }
      ttq.instance = function (t) { for (var e = ttq._i[t] || [], n = 0; n < ttq.methods.length; n++) { ttq.setAndDefer(e, ttq.methods[n]) } return e };
      ttq.load = function (e, n) {
        var i = "https://analytics.tiktok.com/i18n/pixel/events.js";
        ttq._i = ttq._i || {};
        ttq._i[e] = [];
        ttq._i[e]._u = i;
        ttq._t = ttq._t || {};
        ttq._t[e] = +new Date;
        ttq._o = ttq._o || {};
        ttq._o[e] = n || {};
        var o = document.createElement("script");
        o.type = "text/javascript";
        o.async = !0;
        o.src = i + "?sdkid=" + e + "&lib=" + t;
        var a = document.getElementsByTagName("script")[0];
        a.parentNode.insertBefore(o, a)
      };
      ttq.load('D0EVS2JC77U9C23772EG'); // ใส่ TikTok Pixel ID ของคุณ
      ttq.page();
      ttq.track('ViewContent');
    }(window, document, 'ttq');
  </script>

  <!-- Google Ads Pixel -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=AW-17035064059"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'AW-17035064059');
    gtag('event', 'view_item', { value: 1.00, currency: 'THB' });
  </script>

  <style>
    body {font-family: system-ui, sans-serif; display:flex;align-items:center;justify-content:center;height:100vh;margin:0;background:#fafafa;}
    .wrap {text-align:center;}
    .btn {display:inline-block;margin-top:20px;padding:12px 20px;background:#000;color:#fff;font-weight:bold;border-radius:8px;text-decoration:none;}
  </style>
</head>
<body>
  <div class="wrap">
    <h2>กำลังพาไป TikTok…</h2>
    <p>หากไม่ได้เปิดอัตโนมัติ กดปุ่มด้านล่าง</p>
    <a id="fallbackBtn" class="btn" href="https://vt.tiktok.com/ZSSH9A3F7">เปิด TikTok</a>
  </div>

  <script>
    // Deep Link + fallback
    var deepLink = "tiktok://webview?url=https://vt.tiktok.com/ZSSH9A3F7";
    var fallback = "https://vt.tiktok.com/ZSSH9A3F7";

    // ยิง Event ว่าจะพาไปซื้อ
    if(window.fbq) fbq('track', 'InitiateCheckout');
    if(window.ttq) ttq.track('InitiateCheckout');
    if(window.gtag) gtag('event', 'begin_checkout', { value: 1.00, currency: 'THB' });

    // พยายามเปิดแอป TikTok
    window.location = deepLink;

    // ถ้าไม่ได้ผล → fallback หลัง 1 วิ
    setTimeout(function(){
      window.location = fallback;
    }, 1000);
  </script>
</body>
</html>
